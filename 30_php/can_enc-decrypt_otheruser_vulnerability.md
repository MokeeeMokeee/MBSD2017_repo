## サーバにおいて暗号化と復号化を外部から行える脆弱性
### 対象
`util/encrypt.php`,
`util/decrypt.php`

### 危険度
Middle
* この脆弱性単体では直ちにセキュリティインシデントになりうるものはない
* MITMなどで通信が傍受された場合に暗号文を解読され盗み見られる問題がある
* 他行のAPIサーバにも「送信元偽装の脆弱性と暗号化・復号化ができる脆弱性により外部から不正な取引ができてしまう脆弱性」と同様の脆弱性があった場合に暗号化の踏み台として利用される可能性がある

### 解説
今回のプログラムでは、他行との通信のために`util/`に暗号化と復号化を行うプログラムが搭載されている。
この正しい挙動としては、`mode/`にあるプログラムから暗号文を渡して呼び出すのみであるはずだが、
当該のソースコードにはApache等から直接呼び出された場合に暗号・復号化する機能も搭載されていた。
この脆弱性はApacheでのアクセス権不備の問題により派生し発生した問題である。

### 再現方法
以下のコマンド˚でサーバに平文の暗号化を要求できる
```sh
curl http://${SERVER_IP}/util/encrypt.php -X POST -d "This is my message"
```

また、以下のコマンドでサーバに暗号文の復号化を要求できる
```sh
curl http://${SERVER_IP}/util/decrypt.php -X POST -d "暗号文"
```

これにより、攻撃者が暗号鍵を知ることやパディングオラクル攻撃というような攻撃を行うことなく
暗号文を復号し内容を盗聴したり、他行に対して送る予定の不正なリクエストを生成できる

### 条件
特に無し

### 想定される被害・影響
* 他行への不正送金の元銀行となる可能性
    - 信用の失墜
* 盗聴された通信の解読がされる可能性

### 対策
* `encrypt.php`, `decrypt.php` の当該のコードを削除する
  ( if文のelse部すべて )